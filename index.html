<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>제품 목록</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-5">
    <h2 class="mb-4 text-center">📦 제품 재고 리스트</h2>
    <div id="productList" class="row gy-4"></div>
  </div>

 <script>
  fetch('https://fencingstocks.netlify.app/.netlify/functions/sheet')
    .then(res => res.json())
    .then(data => {
      const rows = data.values;
      showData(rows);  // ✅ 함수는 호출만!
    });
  
  function showData(rows) {
    const list = document.getElementById("productList");
    const grouped = {};
  
    // 1. 그룹화: 브랜드 + 제품명 기준
    rows.forEach(row => {
      const brand = row[0] || "";
      const product_name = row[1] || "";
      const key = `${brand}||${product_name}`;
  
      if (!grouped[key]) grouped[key] = [];
      grouped[key].push({
        gender: row[3] || "",
        hand: row[4] || "",
        size: row[5] || "",
        delivery: row[7] || ""
      });
    });
  
    // 2. 그룹별 카드 생성
    Object.entries(grouped).forEach(([key, items]) => {
      const [brand, product_name] = key.split("||");
  
      const col = document.createElement("div");
      col.className = "col-md-6";
  
      let itemListHtml = items.map(item => `
        <div class="border rounded p-2 mb-2 bg-white">
          <strong>성별:</strong> ${item.gender} /
          <strong>손:</strong> ${item.hand} /
          <strong>사이즈:</strong> ${item.size} /
          <strong>배송:</strong> ${item.delivery}
        </div>
      `).join("");
  
      col.innerHTML = `
        <div class="card shadow">
          <div class="card-body">
            <h4 class="card-title">${brand}</h4>
            <h5 class="card-subtitle mb-3 text-muted">${product_name}</h5>
            ${itemListHtml}
          </div>
        </div>
      `;
      list.appendChild(col);
    });
  }
 </script>


</body>
</html>
